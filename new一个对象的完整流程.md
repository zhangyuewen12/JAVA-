# java new一个对象的过程中发生了什么
java在new一个对象的时候，会先查看对象所属的类有没有被加载到内存。如果没有的话，就会通过类的全限定名来加载，加载并初始化类完成后，再进行对象的创建工作。
## 一、类加载过程（第一次使用该类）
首先了解双亲委托模型的工作过程是：如果一个类加载器（CLASS Loader）收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委托给父类加载器去完成，每一个层次的类加载器，都是如此。  
双亲委托机制的好处是：能够有效的确保一个类的全局唯一性，当程序组出现多个限定名相同的类时候，类加载器在执行加载时，始终只会加载其中的某一个类。
类加载过程：
1. 加载   
    由类加载器负责根据一个类的全限定名来读取此类的二进制字节流到JVM内部，并存储在运行时内存区的方法区。然后将其转换为一个与目标类型对应的Java.lang.Class对象实例。该实例对象存在堆区。
2. 验证   
    格式验证是否符合class文件规范   
    语义验证：检查一个被标记final的类型是否包含子类；检查一个类中final方法是否被子类进行重写；确保父类和子类之间没有不兼容的一些方法声明（比如方法签名相同，但方法的返回值不同）。
3. 准备   
    为类中的所有静态变量分配内存空间，并为其设置一个初始值（由于没有产生对象，实例变量不在此操作范围内）  
    被final修饰的static变量（常亮），会直接赋值。
4. 解析   
    将常量池中的所有符号引用转为直接引用（得到类或者字段、方法在内存中的指针或者偏移量，以便直接调用该方法）；
5. 初始化（先父后子）   
    1. 为静态变量赋值
    2. 从上到下执行static代码块
## 二、创建对象
1. 在堆去分配对象需要的内存
    分配的内存包括本类和父类的所有实例变量，但不包括任何静态变量。
2. 对所有实例变量赋默认值
    将方法区对实例变量的定义拷贝一份到堆区，然后赋默认值
3. 执行实例初始化代码
    初始化顺序是先初始化父类再初始化子类，初始化时先执行实例代码块，然后是构造方法。
4. 如果有引用的话，在栈区定义引用变量，并将堆区对象的地址赋值给他